@(showNavButtons: Boolean = true)(body: Html)(implicit session: oxalis.view.SessionData)

@import com.scalableminds.util.tools.Reflect

@callingTemplate = @{
  // TODO: REMOVE HOTFIX
  var c = Reflect.getCallerClass.map( _(8).getName() )
  var i = 8
  val max = 12
  while(c == Some("views.html.main$") && i <= max){
    i += 1
    c = Reflect.getCallerClass.map( _(i).getName() )
  }
  c
}

@pageSkeleton{
    @mainHeader(showNavButtons)
    <div id="alert-container">
      @session.flash.data.map{ f =>
        @if(f._1 == "modal"){
          <div id="flashModal" class="modal modal-message fade" role="dialog" aria-describedby="modalDescription" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-body" id="modalDescription">
                  <p>@f._2</p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
                </div>
              </div>
            </div>
          </div>
        } else {
          <div class="alert alert-@f._1">
            <a href="#" class="close" data-dismiss="alert">Ã—</a>
            @f._2
          </div>
        }
      }
    </div>
    <div id="script-modal" class="modal fade">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h3>Add user script</h3>
          </div>
          <div class="modal-body" id="help-modal-body">
            <textarea id="add-script-input" rows="10"></textarea>
          </div>
          <div class="modal-footer">
            <a href="#" id="add-script-button" class="btn btn-default">Add</a>
            <a href="#" class="btn btn-default" data-dismiss="modal">Close</a>
          </div>
        </div>
      </div>
    </div>
    <div id="main-container" data-template="@callingTemplate">
      <div id="loader">
        <div id="loader-background"></div>
        <div id="loader-icon"><i class="fa fa-spinner fa-spin fa-4x"></i><br>Loading</div>
      </div>
      @body
    </div>
}
