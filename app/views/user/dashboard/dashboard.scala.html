@(dashboardInfo: controllers.DashboardInfo, isAdminView: Boolean)(implicit session: oxalis.view.AuthedSessionData)

@import models.user.time.PaymentInterval
@import scala.concurrent.ExecutionContext.Implicits._
<div class="tabbable" id="tabbable-dashboard" data-url="@controllers.routes.UserController.getDashboardInfo"
>      <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-tasks" data-toggle="tab">Tasks</a></li>
        <li><a href="#tab-explorative" data-toggle="tab">Explorative Tracings</a></li>
        <li><a href="#tab-tracked-time" data-toggle="tab">Tracked Time</a></li>
      </ul>

      <div class="tab-content">
        <div class="tab-pane active" id="tab-tasks">

          <h3>Tasks</h3>
          <br />
          @if(isAdminView){
            <a href="@controllers.admin.routes.NMLIO.userDownload(dashboardInfo.user.id)" title="download all finished tracings">
              <i class="icon-download"></i> download
            </a>
          } else {
            <a href="@controllers.routes.TaskController.request" class="btn btn-success"  data-ajax="add-row=#dashboard-tasks@if(dashboardInfo.hasAnOpenTask){,confirm=@Messages("task.requestAnother")}" id="new-task-button">
              Get a new task
            </a>
          }
          
          <div class="divider-vertical"></div>
          <a href="#" id="toggle-finished">Show finished tasks</a>
          <br /><br />
          <table class="table table-striped mask-finished" id="dashboard-tasks">
            <thead>
              <tr>
                <th> # </th>
                <th> Type </th>
                <th> Project </th>
                <th> Description </th>
                <th> Modes </th>
                <th> </th>
              </tr>
            </thead>
            <tbody class="hide">
              @taskAnnotationTableItem()
            </tbody>
          </table>
        </div>

        <div class="tab-pane" id="tab-explorative">
        
          <h3>Explorative Tracings</h3>
          <br />
          @if(!isAdminView) {
            <div>
              @helper.form(action = controllers.admin.routes.NMLIO.upload, 'enctype -> "multipart/form-data", 'id -> "nml-explore-form", 'class -> "form-inline inline-block"){
                <button type="submit" class="btn"><i class="icon-upload"></i> Upload NML & explore</button>
              }
              <div class="divider-vertical"></div>
              @helper.form(action = controllers.routes.AnnotationController.createExplorational, 'class -> "form-inline inline-block") {
                <select name="dataSetName">
                  @dashboardInfo.dataSets.map{ d =>
                    <option value="@d.dataSource.name"> @d.dataSource.name </option>
                  }
                </select>
                <label class="radio inline hide">
                  <input type="radio" name="contentType" value="skeletonTracing" checked>
                  Skeleton
                </label>
                <label class="radio inline hide">
                  <input type="radio" name="contentType" value="volumeTracing">
                  Volume
                </label>
                <button type="submit" class="btn"><i class="icon-search"></i> Explore data set</button>
              }
            </div>
          }

          <table class="table table-striped table-hover" id="explorative-tasks">
            <thead>
              <tr>
                <th> # </th>
                <th> Name </th>
                <th> DataSet </th>
                <th> SkeletonTracing Stats </th>
                <th> SkeletonTracing-Type </th>
                <th> Last edited </th>
                <th> </th>
              </tr>
            </thead>
            <tbody>
              @exploratoryAnnotationTableItem()
            </tbody>
          </table>
        </div>

        <div class="tab-pane" id="tab-tracked-time">

          <h3>Tracked Time</h3>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th> Month </th>
                  <th> Worked </th>
                </tr>
              </thead>
              <tbody>
              @dashboardInfo.loggedTime.toList.sortBy({ case (interval, time) => interval }).map{ case (interval, time) =>
                <tr>
                  <td> @interval </td>
                  <td> @formatTimeHumanReadable(time) </td>
                </tr>
              }
              </tbody>
            </table>
        </div>
      </div>
    </div>