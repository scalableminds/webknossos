@(teams: List[String], form: Form[(String, String, com.scalableminds.util.geometry.Scale)])(implicit session: oxalis.view.AuthedSessionData)

@main(){
  <div class="container task-types-administration">
    <div class="row">
      <div class="col-md-6">
        <div class="well">
          <h3>Import dataset</h3>
          <br />
          @helper.form(controllers.routes.DataSetController.uploadFromForm, 'class -> "form-horizontal", 'enctype -> "multipart/form-data") {

            @helper.inputText(form("name"), 'type -> "text", 'class -> "form-control")

            @helper.select(form("team"), teams.map { t =>
                t -> t
            }, 'class -> "form-control")

            @helper.inputText(form("scale.scale"), 'type -> "text", 'class -> "form-control", 'pattern -> com.scalableminds.util.geometry.Scale.formRx.toString, 'title -> Messages("scale.invalid"))
            <div class="@{if(form("zipFile").hasErrors) { "has-error" }} form-group">
              <label class="col-sm-3 control-label" for="zipFile">@Messages("dataSet.file")</label>
              <div class="col-sm-9">
                <div class="input-group">
                  <span class="input-group-btn">
                    <span class="btn btn-primary btn-file">
                      Browse… <input type="file" accept="application/zip" name="zipFile">
                    </span>
                  </span>
                  <input type="text" class="file-info form-control" readonly="">
                </div>
                @form.error("zipFile").map { error =>
                    <span class="help-block errors">@error.message</span>
                }
              </div>
            </div>

            <script type="text/javascript">
              require(["jquery"], function($) {
                $("input[type=file]").on("change", function(evt){
                  var files = this.files;
                  if (files) {
                    var fileNames = [];
                    for (var i=0; i < this.files.length; i++)
                        fileNames.push(files[i].name)
                    $(".file-info").val(fileNames.join(", "))
                  }
                })
              })
            </script>

            <div class="form-group">
              <div class="col-sm-9 col-sm-offset-3">
                <button type="submit" class="form-control btn btn-primary">Import</button>
              </div>
            </div>
          }
          <h5>After successful import, it will take about 3 minutes for the data to appear</h5>
        </div>
      </div>
    </div>
  </div>
}
